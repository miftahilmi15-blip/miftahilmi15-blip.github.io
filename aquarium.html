<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium 5D Aquarium</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #001219;
            --glow: #00b4d8;
        }
        body { margin: 0; background: var(--bg); overflow: hidden; font-family: 'Plus Jakarta Sans', sans-serif; }

        /* DEEP WATER EFFECT */
        #ocean {
            width: 100vw; height: 100vh;
            background: radial-gradient(circle at 50% 30%, #005f73 0%, #001219 100%);
            position: relative;
        }

        /* PREMIUM UI CARD */
        .info-card {
            position: fixed; top: 20px; left: 20px; z-index: 100;
            background: rgba(255,255,255,0.05); backdrop-filter: blur(15px);
            padding: 15px 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
            color: white; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* TEXT HADIAH (REQUEST KAKAK) */
        .badge-reward {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 180, 216, 0.15); border: 1px solid var(--glow);
            color: #caf0f8; padding: 10px 25px; border-radius: 50px;
            font-size: 13px; font-weight: 600; text-align: center;
            backdrop-filter: blur(10px); animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.7; box-shadow: 0 0 0px var(--glow); }
            50% { opacity: 1; box-shadow: 0 0 20px var(--glow); }
            100% { opacity: 0.7; box-shadow: 0 0 0px var(--glow); }
        }

        /* FISH ANIMATION */
        .fish {
            position: absolute; width: 120px; pointer-events: none;
            filter: drop-shadow(0 0 15px var(--glow));
            transition: all 10s ease-in-out; /* Gerakan lambat cinematic */
        }

        .fish img { width: 100%; height: auto; }

        .btn-exit {
            position: fixed; top: 20px; right: 20px; width: 45px; height: 45px;
            background: rgba(255,255,255,0.1); border-radius: 15px;
            display: flex; align-items: center; justify-content: center;
            color: white; text-decoration: none; font-size: 24px;
        }
    </style>
</head>
<body>

<div id="ocean">
    <div class="info-card">
        <div style="font-size: 10px; opacity: 0.6; letter-spacing: 2px;">COLLECTION</div>
        <div style="font-size: 28px; font-weight: 800;"><span id="count">0</span> <small style="font-size: 14px;">IKAN</small></div>
    </div>

    <a href="index.html" class="btn-exit">×</a>

    <div class="badge-reward">
        ✨ Membaca Al-Qur'an 30 Menit = Dapat 1 Ikan Baru
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<script>
    // PASTE FIREBASE CONFIG KAKAK DI SINI
    const firebaseConfig = {
        apiKey: "AIzaSyCFVjE7ey5g__Iv4vUOZftB7g8GtSTSsEo",
        authDomain: "e-santri-b62be.firebaseapp.com",
        projectId: "e-santri-b62be",
        databaseURL: "https://e-santri-b62be-default-rtdb.asia-southeast1.firebasedatabase.app"
    };
    firebase.initializeApp(firebaseConfig);

    const libIkan = [
        "https://api.iconify.design/noto:tropical-fish.svg",
        "https://api.iconify.design/noto:fish.svg",
        "https://api.iconify.design/noto:blowfish.svg",
        "https://api.iconify.design/noto:shrimp.svg"
    ];

    firebase.auth().onAuthStateChanged(user => {
        if (user) {
            firebase.database().ref('users/' + user.uid.replace(/\./g, ',') + '/ikan').on('value', snap => {
                const total = snap.val() || 0;
                document.getElementById('count').innerText = total;
                renderIkan(total);
            });
        }
    });

    function renderIkan(total) {
        const container = document.getElementById('ocean');
        document.querySelectorAll('.fish').forEach(f => f.remove());
        
        let jml = (total === 0) ? 1 : total;

        for (let i = 0; i < jml; i++) {
            const f = document.createElement('div');
            f.className = 'fish';
            const randomIkan = libIkan[Math.floor(Math.random() * libIkan.length)];
            f.innerHTML = `<img src="${randomIkan}">`;
            
            f.style.left = Math.random() * 80 + 'vw';
            f.style.top = Math.random() * 80 + 'vh';
            
            container.appendChild(f);
            berenang(f);
        }
    }

    function berenang(el) {
        setInterval(() => {
            const x = Math.random() * 80;
            const y = Math.random() * 80;
            const img = el.querySelector('img');
            
            // Flip ikan sesuai arah berenang
            const curX = parseFloat(el.style.left);
            img.style.transform = (x < curX) ? "scaleX(-1)" : "scaleX(1)";

            el.style.left = x + 'vw';
            el.style.top = y + 'vh';
        }, 10000); // Gerakan super lambat biar tenang
    }
</script>
</body>
</html>
