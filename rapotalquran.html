<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Sistem Rapor Al-Irsyad - Gasa Bos!</title>
    <style>
        :root { --hijau-emerald: #1f6f51; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; background: #222; padding: 20px; }

        /* KONTROL TAMPILAN */
        #layar-input { display: block; }
        #layar-cetak { display: none; }

        /* STYLE FORM INPUT (Mirip Screenshot Bos) */
        .form-card { 
            max-width: 600px; margin: auto; background: white; 
            padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .form-card h2 { color: var(--hijau-emerald); text-align: center; margin-bottom: 25px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .group { margin-bottom: 15px; }
        label { display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px; color: #333; }
        input, textarea, select { 
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; outline: none;
        }
        input:focus { border-color: var(--hijau-emerald); }
        .btn-simpan { 
            width: 100%; padding: 15px; background: var(--hijau-emerald); color: white; 
            border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px;
        }

        /* STYLE RAPOR (Layout F4 Rapi) */
        .page { 
            width: 215mm; height: 330mm; background: white; padding: 15mm 20mm; 
            margin: auto; position: relative; color: black;
        }
        .kop { display: flex; align-items: center; border-bottom: 1px solid #000; padding-bottom: 10px; }
        .kop img { width: 100px; mix-blend-mode: multiply; margin-right: 20px; }
        .kop-text { text-align: center; flex: 1; }
        .kop-text h1 { font-size: 16pt; color: var(--hijau-emerald); font-weight: 900; }
        .kop-text .arab { font-size: 22pt; color: var(--hijau-emerald); font-family: 'Times New Roman'; font-weight: bold; }
        .kop-text p { font-size: 8pt; color: #000; }
        .garis-db { border-bottom: 4px double #000; margin: 3px 0 25px 0; }
        
        .info-siswa { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 11pt; }
        table { width: 100%; border-collapse: collapse; border: 2px solid #000; margin-top: 10px; }
        th, td { border: 1px solid #000; padding: 12px; vertical-align: top; }
        .h-isi { height: 180px; }

        .footer { margin-top: 60px; display: flex; justify-content: space-between; font-size: 11pt; }
        .nama-ttd { margin-top: 80px; font-weight: bold; text-decoration: underline; display: block; }

        @media print {
            body { background: white; padding: 0; }
            #layar-input, .btn-kembali { display: none !important; }
            #layar-cetak { display: block !important; }
            .page { box-shadow: none; margin: 0; }
        }
    </style>
</head>
<body>

    <div id="layar-input">
        <div class="form-card">
            <h2>Input Data Rapor Tahfidz</h2>
            <form id="formRapor">
                <div class="group">
                    <label>Nama Lengkap Santri</label>
                    <input type="text" id="nama" placeholder="Contoh: Adibah" required>
                </div>
                <div class="grid">
                    <div class="group"><label>NISN</label><input type="text" id="nisn"></div>
                    <div class="group"><label>Kelas</label><input type="text" id="kelas" placeholder="7A"></div>
                </div>
                <div class="grid">
                    <div class="group">
                        <label>Semester</label>
                        <select id="semester"><option>Ganjil</option><option>Genap</option></select>
                    </div>
                    <div class="group"><label>Tahun Pelajaran</label><input type="text" id="tp" value="2025/2026"></div>
                </div>
                <div class="group"><label>Pencapaian Tahsin</label><textarea id="tahsin"></textarea></div>
                <div class="group"><label>Keterangan Tahsin</label><textarea id="k_tahsin"></textarea></div>
                <div class="group"><label>Pencapaian Tahfizh</label><textarea id="tahfizh"></textarea></div>
                <div class="group"><label>Keterangan Tahfizh</label><textarea id="k_tahfizh"></textarea></div>
                
                <button type="button" class="btn-simpan" onclick="simpanData()">üöÄ SIMPAN & LIHAT RAPOR</button>
            </form>
        </div>
    </div>

    <div id="layar-cetak">
        <div style="text-align: center; margin-bottom: 20px;" class="btn-kembali">
            <button onclick="lokasiLayarInput()" style="padding:10px 20px; background:#f44336; color:white; border:none; border-radius:5px; cursor:pointer;">‚¨ÖÔ∏è Kembali ke Input</button>
            <button onclick="window.print()" style="padding:10px 20px; background:#222; color:white; border:none; border-radius:5px; cursor:pointer; margin-left:10px;">üñ®Ô∏è Cetak Rapor (F4)</button>
        </div>

        <div class="page">
            <div class="kop">
                <img src="logo.png" onerror="this.src='https://upload.wikimedia.org/wikipedia/id/1/10/Logo_Al-Irsyad_Al-Islamiyyah.png'">
                <div class="kop-text">
                    <p>YAYASAN AL-IRSYAD AL-ISLAMIYYAH KOTA CIREBON</p>
                    <p class="arab">ÿßŸÑŸÖÿØÿ±ÿ≥ÿ© ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© ÿßŸÑÿ•ÿ±ÿ¥ÿßÿØ ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖŸäÿ©</p>
                    <h1>SMP AL-IRSYAD AL-ISLAMIYYAH KOTA CIREBON</h1>
                    <p>Jl. Panjunan No. 27 Cirebon | ‚òè (0231) 234191</p>
                </div>
            </div>
            <div class="garis-db"></div>
            <h3 style="text-align:center; margin-bottom:20px; font-size:12pt;">LAPORAN HASIL BELAJAR TAHSIN & TAHFIZH</h3>
            
            <div class="info-siswa">
                <div>Nama : <b id="r-nama"></b><br>NISN : <span id="r-nisn"></span></div>
                <div style="text-align:right">Kelas : <b id="r-kelas"></b><br>Semester : <span id="r-smstr"></span></div>
            </div>

            <table>
                <tr><th width="50">NO</th><th width="200">PENCAPAIAN</th><th>KETERANGAN</th></tr>
                <tr><td align="center">1</td><td><b>Tahsin</b><br><span id="r-tahsin"></span></td><td id="r-ktahsin" class="h-isi"></td></tr>
                <tr><td align="center">2</td><td><b>Tahfizh</b><br><span id="r-tahfizh"></span></td><td id="r-ktahfizh" class="h-isi"></td></tr>
            </table>

            <div class="footer">
                <div>Mengetahui,<br>Kepala SMP Al-Irsyad<br><span class="nama-ttd">Siti Hamidah, M.Pd</span>NIK. 19860720192027</div>
                <div style="text-align:right">Cirebon, 22 Desember 2025<br>PJ. Al-Qur'an<br><span class="nama-ttd">Ria Setiawati, A.Md</span>NIK. 19900720172057</div>
            </div>
        </div>
    </div>

<script>
    const FIREBASE_URL = "https://e-santri-b62be-default-rtdb.asia-southeast1.firebasedatabase.app/data_rapor";

    async function simpanData() {
        const d = {
            nama: document.getElementById('nama').value,
            nisn: document.getElementById('nisn').value,
            kelas: document.getElementById('kelas').value,
            semester: document.getElementById('semester').value,
            tp: document.getElementById('tp').value,
            tahsin: document.getElementById('tahsin').value,
            k_tahsin: document.getElementById('k_tahsin').value,
            tahfizh: document.getElementById('tahfizh').value,
            k_tahfizh: document.getElementById('k_tahfizh').value
        };

        if(!d.nama) { alert("Nama wajib diisi Bos!"); return; }

        try {
            const id = d.nama.replace(/\s+/g, '_').toLowerCase();
            const res = await fetch(`${FIREBASE_URL}/${id}.json`, {
                method: 'PUT',
                body: JSON.stringify(d)
            });

            if(res.ok) {
                alert("‚úÖ Alhamdulillah, Data Tersimpan!");
                // Isi data ke tampilan rapor
                document.getElementById('r-nama').innerText = d.nama;
                document.getElementById('r-nisn').innerText = d.nisn;
                document.getElementById('r-kelas').innerText = d.kelas;
                document.getElementById('r-smstr').innerText = d.semester;
                document.getElementById('r-tahsin').innerText = d.tahsin;
                document.getElementById('r-ktahsin').innerText = d.k_tahsin;
                document.getElementById('r-tahfizh').innerText = d.tahfizh;
                document.getElementById('r-ktahfizh').innerText = d.k_tahfizh;

                // Tukar Layar
                document.getElementById('layar-input').style.display = 'none';
                document.getElementById('layar-cetak').style.display = 'block';
            }
        } catch (e) { alert("Gagal Simpan Bos!"); }
    }

    function lokasiLayarInput() {
        document.getElementById('layar-input').style.display = 'block';
        document.getElementById('layar-cetak').style.display = 'none';
    }
</script>
</body>
</html>
