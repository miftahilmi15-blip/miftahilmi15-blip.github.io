<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>E-Santri | Modern Edition</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=Montserrat:wght@900&family=Noto+Naskh+Arabic:wght@700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #1f6f51;
    --primary-light: #2ecc71;
    --accent: #d4b96a;      
    --text: #2d3436;
    --muted: #636e72;
    --bg: #f8fafb;
    --white: #ffffff;
    --glass: rgba(255, 255, 255, 0.9);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Plus Jakarta Sans", sans-serif; }
  
  body {
    background: var(--bg);
    color: var(--text);
    padding: 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* LOADING */
  #loading-screen {
    position: fixed; inset: 0; background: var(--bg);
    display: flex; align-items: center; justify-content: center; z-index: 9999;
  }
  .spinner {
    width: 40px; height: 40px; border: 4px solid #ddd;
    border-top: 4px solid var(--primary); border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .container { width: 100%; max-width: 420px; }

  /* HEADER TANPA LOGO PNG */
  .header-box { text-align: center; padding: 30px 0; }
  .title { 
    font-family: 'Montserrat', sans-serif;
    font-size: 32px; font-weight: 900; color: var(--primary);
    letter-spacing: 1px; text-transform: uppercase;
  }

  /* STREAK DASHBOARD */
  .streak-card {
    background: linear-gradient(135deg, var(--primary), #16a085);
    border-radius: 24px; padding: 20px; color: white;
    margin-bottom: 20px; display: flex; align-items: center; justify-content: space-between;
    box-shadow: 0 10px 20px rgba(31, 111, 81, 0.2);
  }
  .streak-info h4 { font-size: 14px; opacity: 0.9; font-weight: 400; }
  .streak-info h2 { font-size: 24px; font-weight: 800; }
  .streak-icon { font-size: 40px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.3)); }

  /* MAHFUZAT TICKER */
  .mahfuzat-ticker {
    background: white; margin-bottom: 20px; padding: 10px 15px;
    border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.03);
    display: flex; align-items: center; overflow: hidden;
  }
  .ticker-label {
    background: var(--accent); color: white; font-size: 10px;
    font-weight: 800; padding: 4px 8px; border-radius: 5px; margin-right: 10px;
  }
  .ticker-content marquee { font-size: 13px; font-weight: 600; }

  /* MENU GRID - ICON BERBASIS EMOJI/CSS (TANPA PNG) */
  .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
  .menu-item { 
    background: white; padding: 20px 10px; border-radius: 20px; text-align: center; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.03); transition: 0.3s; cursor: pointer;
    border: 1px solid rgba(0,0,0,0.02);
  }
  .menu-item:active { transform: scale(0.95); background: #f0fdf4; }
  .menu-symbol { 
    font-size: 32px; display: block; margin-bottom: 8px; 
    filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1));
  }
  .menu-item span { font-size: 11px; font-weight: 700; color: var(--text); }

  /* SIDEBAR & OVERLAY */
  .menu-trigger {
    position: fixed; top: 20px; right: 20px; z-index: 1000;
    background: white; width: 45px; height: 45px; border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1); cursor: pointer; font-size: 20px;
  }
  .sidebar {
    position: fixed; top: 0; right: -80%; width: 80%; height: 100%;
    background: white; z-index: 1100; padding: 40px 20px;
    transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .sidebar.open { right: 0; box-shadow: -10px 0 30px rgba(0,0,0,0.1); }
  .overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.3);
    display: none; z-index: 1050; backdrop-filter: blur(4px);
  }

  /* BUTTONS & INPUT */
  .card { background: white; padding: 30px; border-radius: 24px; width: 100%; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
  input { width: 100%; padding: 14px; margin-bottom: 12px; border-radius: 12px; border: 1px solid #eee; outline: none; background: #f9f9f9; }
  .btn { width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: 700; cursor: pointer; transition: 0.3s; }
  .btn.primary { background: var(--primary); color: white; }
  
  .hidden { display: none !important; }
  footer { margin-top: auto; padding: 20px; font-size: 10px; font-weight: 800; color: var(--muted); letter-spacing: 2px; }
</style>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
</head>
<body>

<div id="loading-screen"><div class="spinner"></div></div>

<div class="menu-trigger" id="menu-btn" style="display:none;">‚ò∞</div>

<div class="overlay" id="overlay"></div>
<div class="sidebar" id="sidebar">
    <div style="text-align:center; margin-bottom:30px;">
        <div id="user-initial" style="width:70px; height:70px; background:var(--soft); color:var(--primary); border-radius:50%; margin:0 auto 10px; display:flex; align-items:center; justify-content:center; font-size:30px; font-weight:800; border: 2px solid var(--primary);">S</div>
        <h3 id="sidebar-name">Santri</h3>
    </div>
    <div style="display:flex; flex-direction:column; gap:10px;">
        <button class="btn" onclick="location.reload()">üè† Dashboard</button>
        <button class="btn" style="color:red" onclick="logout()">üö™ Keluar</button>
    </div>
</div>

<header class="header-box">
  <h1 class="title">E-SANTRI</h1>
</header>

<main class="container">
  <div id="login-card" class="card hidden">
    <h2 style="text-align:center; margin-bottom:20px; color:var(--primary)">Ahlan wa Sahlan</h2>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <button class="btn primary" onclick="login()">MASUK</button>
  </div>

  <section id="dashboard" class="hidden">
    <div class="streak-card">
        <div class="streak-info">
            <h4>Al-Qur'an Streak</h4>
            <h2 id="streak-count">7 Hari Berturut</h2>
        </div>
        <div class="streak-icon">üî•</div>
    </div>

    <div class="mahfuzat-ticker">
        <div class="ticker-label">MAHFUZAT</div>
        <div class="ticker-content">
            <marquee id="marquee-text">Loading Mahfuzat...</marquee>
        </div>
    </div>

    <div class="menu-grid">
      <div class="menu-item" onclick="goTo('absensi.html')"><span class="menu-symbol">üìù</span><span>Absensi</span></div>
      <div class="menu-item" onclick="goTo('tahfidz.html')"><span class="menu-symbol">üèÜ</span><span>Tahfidz</span></div>
      <div class="menu-item" onclick="goTo('alquran.html')"><span class="menu-symbol">üìñ</span><span>Al-Quran</span></div>
      <div class="menu-item" onclick="goTo('kamus.html')"><span class="menu-symbol">üìë</span><span>Kamus</span></div>
      <div class="menu-item" onclick="goTo('perpustakaan.html')"><span class="menu-symbol">üìö</span><span>Perpus</span></div>
      <div class="menu-item" onclick="goTo('budayasekolah.html')"><span class="menu-symbol">üïå</span><span>Budaya</span></div>
    </div>
  </section>
</main>

<footer>JANGAN TINGGALKAN SHOLAT</footer>

<script>
  // Firebase Config (Tetap dari kode Ustadz)
  firebase.initializeApp({
    apiKey:"AIzaSyAQ1A9rtEoEYoriA5Y7oSB84Fd1Xnu6aes",
    authDomain:"e-santri-ed555.firebaseapp.com",
    projectId:"e-santri-ed555"
  });
  const auth = firebase.auth();

  function goTo(url) { window.location.href = url; }

  // Logika Streak Quran (Simulasi sederhana pakai LocalStorage)
  function updateStreak() {
    let streak = localStorage.getItem('quran_streak') || 0;
    document.getElementById('streak-count').innerText = streak + " Hari Berturut";
  }

  function login(){
    const email=document.getElementById("email").value;
    const pass=document.getElementById("password").value;
    auth.signInWithEmailAndPassword(email,pass).catch(e=> alert(e.message));
  }

  function logout(){ auth.signOut().then(()=>location.reload()); }

  auth.onAuthStateChanged(user => {
    document.getElementById("loading-screen").style.display = "none";
    if(user){
      document.getElementById("login-card").classList.add("hidden");
      document.getElementById("dashboard").classList.remove("hidden");
      document.getElementById("menu-btn").style.display="flex";
      document.getElementById("sidebar-name").innerText = user.displayName || "Santri";
      document.getElementById("user-initial").innerText = (user.displayName || "S").charAt(0);
      updateStreak();
    } else {
      document.getElementById("login-card").classList.remove("hidden");
      document.getElementById("dashboard").classList.add("hidden");
    }
  });

  // Sidebar
  const sidebar = document.getElementById("sidebar"), overlay = document.getElementById("overlay");
  document.getElementById("menu-btn").onclick = () => { sidebar.classList.add("open"); overlay.style.display="block"; }
  overlay.onclick = () => { sidebar.classList.remove("open"); overlay.style.display="none"; }
</script>
</body>
</html>
