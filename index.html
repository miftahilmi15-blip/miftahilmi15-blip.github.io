<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">

<title>E-Santri</title>

<!-- PWA -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#1f6f51">

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800;900&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<style>
:root{
--primary:#1f6f51;
--primary-grad:linear-gradient(135deg,#1f6f51,#2ecc71);
--bg:#f8faf9;
--text:#2d3436;
--shadow:0 10px 30px rgba(31,111,81,.1);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}
body{background:var(--bg);color:var(--text);min-height:100vh}
.hide{display:none!important}

/* layout */
.container{max-width:420px;margin:auto;padding:20px}
.header-box{text-align:center;padding:25px 0}
.title{font-family:Montserrat;font-size:32px;font-weight:900;color:var(--primary)}

/* loading */
#loading{
position:fixed;inset:0;background:var(--bg);
display:flex;align-items:center;justify-content:center;
font-weight:700;color:var(--primary);z-index:9999
}

/* login */
.card-login{
background:#fff;padding:40px 30px;border-radius:35px;
box-shadow:var(--shadow);text-align:center
}
.btn-google{
width:100%;padding:14px;border-radius:16px;border:1.5px solid #eee;
background:#fff;display:flex;align-items:center;justify-content:center;
gap:12px;font-weight:700;margin-top:20px;cursor:pointer
}

/* dashboard */
.menu-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px}
.menu-item{
background:#fff;padding:22px 10px;border-radius:24px;
text-align:center;box-shadow:var(--shadow)
}
.menu-symbol{font-size:32px;display:block;margin-bottom:8px}

/* sidebar */
.menu-trigger{
position:fixed;top:25px;right:25px;width:48px;height:48px;
background:#fff;border-radius:14px;display:none;
align-items:center;justify-content:center;
box-shadow:var(--shadow);z-index:2000;cursor:pointer
}
.sidebar{
position:fixed;inset:0;background:#fff;
display:flex;flex-direction:column;align-items:center;justify-content:center;
transform:translateX(100%);transition:.4s;z-index:3000
}
.sidebar.open{transform:none}
.close-sidebar{position:absolute;top:30px;right:30px;font-size:30px;cursor:pointer}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
</head>

<body>

<div id="loading">Memuat‚Ä¶</div>

<div class="menu-trigger" id="menuBtn"><i class="fa fa-bars"></i></div>

<div class="sidebar" id="sidebar">
<div class="close-sidebar" id="closeSidebar">‚úï</div>
<h3 id="uName">Santri</h3>
<p id="uEmail" style="color:#999;font-size:12px"></p>
<br>
<button onclick="logout()">Keluar</button>
</div>

<main class="container">
<header class="header-box"><h1 class="title">E-SANTRI</h1></header>

<!-- LOGIN -->
<div id="loginCard" class="card-login">
<h2 style="color:var(--primary)">Ahlan wa Sahlan</h2>

<input id="email" type="email" placeholder="Email"
style="width:100%;padding:15px;margin:15px 0;border-radius:12px;border:1px solid #eee">

<input id="password" type="password" placeholder="Password"
style="width:100%;padding:15px;margin-bottom:20px;border-radius:12px;border:1px solid #eee">

<button onclick="login()"
style="width:100%;padding:16px;border-radius:16px;border:none;
background:var(--primary-grad);color:#fff;font-weight:700">
MASUK
</button>

<div style="margin:20px;color:#ccc">‚Äî ATAU ‚Äî</div>

<button class="btn-google" onclick="loginGoogle()">
<img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/pwa/google.svg" width="22">
Masuk dengan Google
</button>
</div>

<!-- DASHBOARD -->
<section id="dashboard" class="hide">
<div class="menu-grid">
<div class="menu-item"><span class="menu-symbol">üìñ</span>Al-Quran</div>
<div class="menu-item"><span class="menu-symbol">üìù</span>Absensi</div>
<div class="menu-item"><span class="menu-symbol">üèÜ</span>Tahfidz</div>
</div>
</section>
</main>

<script>
/* Firebase init */
firebase.initializeApp({
apiKey:"AIzaSyCFVjE7ey5g__Iv4vUOZftB7g8GtSTSsEo",
authDomain:"e-santri-b62be.firebaseapp.com",
projectId:"e-santri-b62be"
});
const auth = firebase.auth();

/* Elements */
const loading = document.getElementById("loading");
const loginCard = document.getElementById("loginCard");
const dashboard = document.getElementById("dashboard");
const menuBtn = document.getElementById("menuBtn");
const sidebar = document.getElementById("sidebar");
const uName = document.getElementById("uName");
const uEmail = document.getElementById("uEmail");

/* Sidebar */
menuBtn.onclick = () => sidebar.classList.add("open");
closeSidebar.onclick = () => sidebar.classList.remove("open");

/* Auth */
function login(){
auth.signInWithEmailAndPassword(email.value,password.value)
.catch(e=>alert(e.message));
}
function loginGoogle(){
const p=new firebase.auth.GoogleAuthProvider();
p.setCustomParameters({prompt:"select_account"});
auth.signInWithRedirect(p);
}
function logout(){
auth.signOut().then(()=>location.reload());
}

/* Auth state */
auth.onAuthStateChanged(user=>{
loading.style.display="none";
if(user){
loginCard.classList.add("hide");
dashboard.classList.remove("hide");
menuBtn.style.display="flex";
uName.innerText=user.displayName||"Santri";
uEmail.innerText=user.email;
}else{
loginCard.classList.remove("hide");
dashboard.classList.add("hide");
menuBtn.style.display="none";
}
});

/* PWA Service Worker */
if("serviceWorker" in navigator){
window.addEventListener("load",()=>{
navigator.serviceWorker.register("/sw.js");
});
}
</script>

</body>
</html>
