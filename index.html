<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>E-SANTRI PREMIUM | v25 Final</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #1f6f51;
    --glass: rgba(255, 255, 255, 0.8);
    --bg-water: #bce3db;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
  body { background: var(--bg-water); height: 100vh; overflow: hidden; position: relative; }

  /* --- IKAN KOI 5D REALISTIS --- */
  .koi-fish {
    position: absolute; width: 100px; height: 50px; z-index: 1;
    pointer-events: none; transition: all 5s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .koi-body {
    width: 100%; height: 100%;
    animation: meliuk 1.2s infinite ease-in-out;
    filter: drop-shadow(15px 20px 12px rgba(0,0,0,0.15)); /* Bayangan dasar kolam */
  }
  @keyframes meliuk {
    0%, 100% { transform: skewY(0deg) scaleX(1); }
    50% { transform: skewY(6deg) scaleX(1.05); }
  }

  /* --- UI INTERFACE --- */
  .ui-wrapper {
    position: relative; z-index: 10; height: 100vh;
    padding: 25px; display: flex; flex-direction: column;
    background: radial-gradient(circle at top, transparent, rgba(0,0,0,0.05));
  }

  header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
  .logo { font-family: 'Montserrat'; font-size: 24px; color: var(--primary); letter-spacing: 3px; }
  .profile-trigger { width: 45px; height: 45px; border-radius: 15px; background: white; border: 2px solid var(--primary); overflow: hidden; cursor: pointer; }

  /* STREAK CARD */
  .card-glass {
    background: var(--glass); backdrop-filter: blur(15px);
    border-radius: 25px; padding: 20px; border: 1px solid rgba(255,255,255,0.6);
    box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 20px;
  }
  .streak-title { font-size: 11px; font-weight: 700; color: #888; letter-spacing: 1px; }
  .streak-num { font-size: 26px; font-weight: 800; color: var(--primary); }

  /* MENU GRID 2 KOLOM */
  .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
  .menu-btn {
    background: var(--glass); backdrop-filter: blur(10px);
    height: 110px; border-radius: 25px; display: flex; flex-direction: column;
    align-items: center; justify-content: center; cursor: pointer; transition: 0.3s;
    border: 1px solid rgba(255,255,255,0.4);
  }
  .menu-btn:active { transform: scale(0.92); background: white; }
  .menu-btn i { font-size: 28px; margin-bottom: 8px; }
  .menu-btn span { font-size: 13px; font-weight: 600; color: #444; }

  /* MAHFUZAT BANNER */
  .footer-banner {
    margin-top: auto; background: var(--primary); border-radius: 20px;
    padding: 12px; overflow: hidden; white-space: nowrap;
  }
  .scrolling-text { display: inline-block; color: white; font-size: 14px; animation: jalan 15s linear infinite; }
  @keyframes jalan { from { transform: translateX(100%); } to { transform: translateX(-100%); } }

  /* SIDEBAR */
  .sidebar {
    position: fixed; top: 0; right: -80%; width: 80%; height: 100%;
    background: white; z-index: 1000; padding: 50px 30px;
    transition: 0.5s cubic-bezier(0.7, 0, 0.3, 1); border-radius: 40px 0 0 40px;
  }
  .sidebar.open { right: 0; box-shadow: -20px 0 50px rgba(0,0,0,0.1); }
  .sidebar a { display: block; padding: 15px; color: #333; text-decoration: none; font-weight: 600; border-bottom: 1px solid #f0f0f0; }

  .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.2); backdrop-filter: blur(5px); z-index: 900; }
  .pelet { position: absolute; width: 10px; height: 10px; background: orange; border-radius: 50%; z-index: 5; animation: sink 1s forwards; }
  @keyframes sink { to { transform: scale(0.5); opacity: 0; } }
</style>
</head>
<body onclick="kasihMakan(event)">

<div class="overlay" id="ovl"></div>

<div class="ui-wrapper">
  <header>
    <div class="logo">E-SANTRI</div>
    <div class="profile-trigger" id="open-menu">
      <img id="u-img" src="https://via.placeholder.com/50" style="width:100%">
    </div>
  </header>

  <div class="card-glass">
    <p class="streak-title">DAILY QURAN STREAK</p>
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <span class="streak-num" id="s-count">0 Hari</span>
      <span style="font-size:35px;">ğŸ”¥</span>
    </div>
  </div>

  <div class="menu-grid">
    <div class="menu-btn" onclick="location.href='absensi.html'"><i>ğŸ“</i><span>Absensi</span></div>
    <div class="menu-btn" onclick="location.href='tahfidz.html'"><i>ğŸ†</i><span>Tahfidz</span></div>
    <div class="menu-btn" onclick="location.href='alquran.html'"><i>ğŸ“–</i><span>Al-Quran</span></div>
    <div class="menu-btn" onclick="location.href='perpustakaan.html'"><i>ğŸ“š</i><span>Perpus</span></div>
    <div class="menu-btn" onclick="location.href='pengaduan.html'"><i>ğŸ“£</i><span>Pengaduan</span></div>
    <div class="menu-btn" onclick="location.href='budayasekolah.html'"><i>ğŸ•Œ</i><span>Budaya</span></div>
  </div>

  <div class="footer-banner">
    <div class="scrolling-text" id="m-text">Ù…ÙÙ†Ù’ Ø¬ÙØ¯ÙÙ‘ ÙˆÙØ¬ÙØ¯Ù â€” Siapa yang bersungguh-sungguh akan berhasil.</div>
  </div>
</div>

<div class="sidebar" id="sb">
  <h2 style="color:var(--primary); margin-bottom:20px;">Menu Santri</h2>
  <a href="#" onclick="location.reload()">ğŸ  Dashboard</a>
  <a href="#" onclick="location.href='kalender.html'">ğŸ“… Kalender</a>
  <a href="#" onclick="location.href='sholat.html'">ğŸ•Œ Waktu Sholat</a>
  <a href="#" onclick="location.href='pengaduan.html'">ğŸ“£ Layanan Pengaduan</a>
  <a href="#" onclick="logout()" style="color:red; margin-top:30px;">ğŸšª Logout Akun</a>
</div>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

<script>
  firebase.initializeApp({ apiKey:"AIzaSyAQ1A9rtEoEYoriA5Y7oSB84Fd1Xnu6aes", authDomain:"e-santri-ed555.firebaseapp.com", projectId:"e-santri-ed555" });

  // --- LOGIKA IKAN KOI 5D ---
  const koiSVG = `
    <svg viewBox="0 0 120 60" class="koi-body">
      <path d="M90,30 Q110,10 115,30 Q110,50 90,30" fill="#ff7675" opacity="0.8" />
      <path d="M10,30 Q30,5 70,15 Q90,30 70,45 Q30,55 10,30" fill="white" />
      <ellipse cx="40" cy="25" rx="15" ry="10" fill="#ff7675" />
      <circle cx="20" cy="22" r="2" fill="black" />
      <circle cx="20" cy="38" r="2" fill="black" />
    </svg>`;

  const fishes = [];
  function createFish() {
    for(let i=0; i<5; i++) {
      const f = document.createElement('div');
      f.className = 'koi-fish';
      f.innerHTML = koiSVG;
      f.x = Math.random() * 80; f.y = Math.random() * 80;
      f.style.left = f.x + 'vw'; f.style.top = f.y + 'vh';
      document.body.appendChild(f);
      fishes.push({ el: f, x: f.x, y: f.y });
    }
    swim();
  }

  function swim() {
    fishes.forEach(f => {
      const nx = Math.random() * 85; const ny = Math.random() * 85;
      const angle = Math.atan2(ny - f.y, nx - f.x) * 180 / Math.PI;
      f.el.style.left = nx + 'vw'; f.el.style.top = ny + 'vh';
      f.el.style.transform = `rotate(${angle}deg)`;
      f.x = nx; f.y = ny;
    });
    setTimeout(swim, 5000);
  }

  function kasihMakan(e) {
    if(e.target.closest('.menu-btn')) return;
    const p = document.createElement('div');
    p.className = 'pelet';
    p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 1000);

    fishes.forEach(f => {
      const tx = e.clientX - 50; const ty = e.clientY - 25;
      const angle = Math.atan2(ty - (f.y * window.innerHeight/100), tx - (f.x * window.innerWidth/100)) * 180 / Math.PI;
      f.el.style.transition = 'all 1.5s ease-out';
      f.el.style.left = tx + 'px'; f.el.style.top = ty + 'px';
      f.el.style.transform = `rotate(${angle}deg)`;
      setTimeout(() => f.el.style.transition = 'all 5s ease-in-out', 2000);
    });
  }

  // --- LOGIKA AUTH ---
  function logout(){ firebase.auth().signOut().then(()=>location.reload()); }
  firebase.auth().onAuthStateChanged(user => {
    if(user){
      document.getElementById("u-img").src = user.photoURL;
      document.getElementById("s-count").innerText = (localStorage.getItem('q_streak') || "0") + " Hari";
      createFish();
    } else {
      firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider());
    }
  });

  // SIDEBAR CONTROL
  const sbar = document.getElementById('sb'), ovl = document.getElementById('ovl');
  document.getElementById('open-menu').onclick = () => { sbar.classList.add('open'); ovl.style.display = 'block'; }
  ovl.onclick = () => { sbar.classList.remove('open'); ovl.style.display = 'none'; }
</script>
</body>
</html>
