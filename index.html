<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>E-Santri | Real Version</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root { --primary: #1b4d3e; --bg: #e0f2f1; }
  * { margin:0; padding:0; box-sizing:border-box; font-family:"Poppins",sans-serif; }
  body { background: var(--bg); min-height:100vh; overflow:hidden; }
  .hidden { display:none !important; }

  /* BACKGROUND */
  #pond-base { position:fixed; inset:0; z-index:1; background:radial-gradient(circle at center, #80cbc4, #1b4d3e); }

  /* LOGIN & DAFTAR CARD */
  #auth-screen { 
    position:fixed; inset:0; z-index:9999; background:var(--bg); 
    display:flex; justify-content:center; align-items:center; padding:20px; 
  }
  .auth-card { 
    background:white; width:100%; max-width:350px; padding:30px; 
    border-radius:30px; box-shadow:0 20px 50px rgba(0,0,0,0.1); text-align:center; 
  }
  input { width:100%; padding:14px; margin-bottom:10px; border-radius:12px; border:1px solid #ddd; outline:none; }
  .btn-main { width:100%; padding:14px; border-radius:12px; border:none; background:linear-gradient(135deg,#1b4d3e,#3e7c6d); color:white; font-weight:700; cursor:pointer; margin-top:5px; }
  .btn-google { width:100%; padding:14px; border-radius:12px; border:1px solid #ddd; background:white; margin-top:10px; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:10px; font-weight:600; }
  .toggle-link { margin-top:15px; font-size:12px; color: #666; cursor:pointer; display:block; }
  .toggle-link b { color: var(--primary); }

  /* DASHBOARD */
  header { background:linear-gradient(135deg,#1b4d3e,#3e7c6d); padding:30px 25px 80px; border-radius:0 0 45px 45px; position:relative; z-index:100; color:white; }
  .container { width:92%; max-width:400px; margin:-50px auto 20px; position:relative; z-index:110; }
  .menu-grid { display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; }
  .menu-item { background:white; padding:20px 5px; border-radius:20px; text-align:center; box-shadow:0 8px 20px rgba(0,0,0,0.1); cursor:pointer; }
</style>
</head>
<body>

<div id="pond-base"></div>

<section id="auth-screen">
  <div class="auth-card">
    <h2 id="auth-title" style="color:var(--primary); margin-bottom:5px;">E-Santri</h2>
    <p id="auth-subtitle" style="font-size:12px; color:#888; margin-bottom:20px;">Silakan Masuk</p>
    
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    
    <button class="btn-main" id="auth-btn" onclick="handleAuth()">MASUK</button>
    
    <button class="btn-google" onclick="loginGoogle()">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/pwa/google.svg" width="18"> Login Google
    </button>
    
    <span class="toggle-link" id="toggle-auth" onclick="toggleMode()">Belum punya akun? <b>Daftar Disini</b></span>
    <p id="error-msg" style="color:red; font-size:11px; margin-top:10px;"></p>
  </div>
</section>

<header id="app-header" class="hidden">
  <h1 style="font-size:22px; font-weight:800;">E-SANTRI</h1>
  <p id="welcome-msg" style="opacity:0.8; font-size:12px;"></p>
</header>

<main id="main-content" class="container hidden">
  <div class="menu-grid">
    <div class="menu-item" onclick="alert('Menu Absensi')"><span>üåê</span><p style="font-size:10px; font-weight:700;">ABSENSI</p></div>
    <div class="menu-item" onclick="alert('Menu Al-Quran')"><span>üìñ</span><p style="font-size:10px; font-weight:700;">AL-QURAN</p></div>
    <div class="menu-item" onclick="logout()"><span>üö™</span><p style="font-size:10px; font-weight:700;">LOGOUT</p></div>
  </div>
</main>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCFVjE7ey5g__Iv4vUOZftB7g8GtSTSsEo",
    authDomain: "e-santri-b62be.firebaseapp.com",
    projectId: "e-santri-b62be",
    storageBucket: "e-santri-b62be.firebasestorage.app",
    messagingSenderId: "6560427635",
    appId: "1:6560427635:web:368b4fbf95163e8d214406"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  let isLoginMode = true;

  function toggleMode() {
    isLoginMode = !isLoginMode;
    document.getElementById('auth-title').innerText = isLoginMode ? "E-Santri" : "Daftar Akun";
    document.getElementById('auth-subtitle').innerText = isLoginMode ? "Silakan Masuk" : "Buat akun baru santri";
    document.getElementById('auth-btn').innerText = isLoginMode ? "MASUK" : "DAFTAR SEKARANG";
    document.getElementById('toggle-auth').innerHTML = isLoginMode ? "Belum punya akun? <b>Daftar Disini</b>" : "Sudah punya akun? <b>Login Saja</b>";
  }

  function handleAuth() {
    const email = document.getElementById('email').value;
    const pass = document.getElementById('password').value;
    const msg = document.getElementById('error-msg');
    
    if(isLoginMode) {
      auth.signInWithEmailAndPassword(email, pass).catch(e => msg.innerText = e.message);
    } else {
      auth.createUserWithEmailAndPassword(email, pass).then(() => {
        alert("Pendaftaran Berhasil! Silakan Masuk.");
        toggleMode();
      }).catch(e => msg.innerText = e.message);
    }
  }

  function loginGoogle() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).catch(e => alert("Gagal Google: " + e.message));
  }

  function logout() { auth.signOut().then(() => location.reload()); }

  auth.onAuthStateChanged(user => {
    if(user) {
      document.getElementById('auth-screen').classList.add('hidden');
      document.getElementById('app-header').classList.remove('hidden');
      document.getElementById('main-content').classList.remove('hidden');
      document.getElementById('welcome-msg').innerText = "Ahlan, " + (user.email);
    }
  });
</script>
</body>
</html>
