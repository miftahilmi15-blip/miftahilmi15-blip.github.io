<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mushaf Digital Al-Itqan Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1f6f51;
            --accent: #c5a059;
            --bg-mushaf: #fdfaf4;
            --glass: rgba(255, 255, 255, 0.9);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: #eef2ee; color: #2d3436; padding-top: 190px; }

        /* HEADER & TOP AUDIO PLAYER (AESTHETIC OVERLAY) */
        header {
            position: fixed; top: 0; left: 0; right: 0;
            background: linear-gradient(135deg, var(--primary), #144d38);
            color: white; padding: 15px 20px; z-index: 1000;
            border-radius: 0 0 25px 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .header-top h2 { font-family: 'Amiri', serif; font-size: 1.5rem; }

        /* KEBAB MENU (Tiga Titik) */
        .menu-dots { cursor: pointer; padding: 5px; font-size: 22px; }
        .dropdown {
            display: none; position: absolute; right: 20px; top: 60px;
            background: white; color: var(--text-main); border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); width: 200px; overflow: hidden;
        }
        .dropdown a { 
            display: block; padding: 12px 20px; text-decoration: none; 
            color: #333; font-size: 13px; font-weight: 600; border-bottom: 1px solid #eee;
        }
        .dropdown a:hover { background: #f0f7f4; color: var(--primary); }

        /* AUDIO STYLES AT TOP */
        .audio-box { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 15px; backdrop-filter: blur(5px); }
        .audio-box span { font-size: 10px; display: block; margin-bottom: 5px; opacity: 0.9; text-align: center; font-weight: 700; }
        audio { width: 100%; height: 32px; filter: sepia(20%) saturate(70%) grayscale(100%) contrast(90%) invert(100%); }

        .surah-nav { margin-top: 10px; width: 100%; padding: 8px; border-radius: 10px; border: none; font-weight: 600; }

        /* MAIN MUSHAF */
        .main-content { max-width: 600px; margin: 0 auto 50px; padding: 0 15px; }
        .mushaf-card {
            background: var(--bg-mushaf); border-radius: 30px; padding: 40px 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); min-height: 80vh;
        }

        .ayah-text {
            direction: rtl; text-align: justify; line-height: 2.8;
            font-family: 'Amiri', serif; font-size: 28px; cursor: pointer; transition: 0.3s;
            display: inline;
        }
        .ayah-text:hover { background: rgba(197, 160, 89, 0.1); border-radius: 5px; }

        .ayah-num {
            display: inline-flex; align-items: center; justify-content: center;
            width: 38px; height: 38px; margin: 0 10px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 0 L93 25 L93 75 L50 100 L7 75 L7 25 Z" fill="none" stroke="%23c5a059" stroke-width="4"/></svg>');
            background-size: contain; font-size: 12px; font-weight: bold; font-family: sans-serif; direction: ltr;
        }

        /* TRANSLATION POPUP (MODAL) */
        .modal {
            display: none; position: fixed; bottom: 0; left: 0; right: 0;
            background: white; padding: 25px; border-radius: 25px 25px 0 0;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.2); z-index: 2000;
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .modal-header { display: flex; justify-content: space-between; font-weight: 800; color: var(--primary); margin-bottom: 10px; font-size: 14px; }
        .modal-body { font-size: 15px; line-height: 1.6; color: #444; }

        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <div class="header-top">
        <h2 id="currentSurahName">Al-Qur'anul Karim</h2>
        <div class="menu-dots" onclick="toggleMenu()">‚ãÆ</div>
        <div id="myDropdown" class="dropdown">
            <a href="#" onclick="alert('Pelajaran Gharib: Saktah, Isymam, Imalah, Tashil, Naql (Sumber: Qiraati)')">üìñ Pelajaran Gharib</a>
            <a href="#" onclick="alert('Hukum Tajwid: Ikhfa, Idgham, Iqlab, Izhar (Sumber: Kitab Tajwid Qiraati)')">üìó Hukum Tajwid</a>
            <a href="#" onclick="showWaqaf()">üìè Tanda Waqaf</a>
        </div>
    </div>
    
    <div class="audio-box">
        <span id="audioStatus">Mendengarkan: Mishary Rashid</span>
        <audio id="mainAudio" controls></audio>
    </div>

    <select id="surahSelect" class="surah-nav"></select>
</header>

<div class="main-content">
    <div class="mushaf-card" id="quranContainer">
        <div id="quranText">Memuat Mushaf...</div>
    </div>
</div>

<div id="translationModal" class="modal">
    <div class="modal-header">
        <span id="modalAyahTitle">Ayat</span>
        <span style="cursor:pointer" onclick="closeModal()">‚úï</span>
    </div>
    <div id="modalAyahText" class="modal-body"></div>
</div>

<script>
    const surahSelect = document.getElementById("surahSelect");
    const quranText = document.getElementById("quranText");
    const mainAudio = document.getElementById("mainAudio");
    const audioStatus = document.getElementById("audioStatus");

    // 1. Fetch Daftar Surah
    fetch("https://api.quran.gading.dev/surah")
        .then(r => r.json())
        .then(d => {
            d.data.forEach(s => {
                let opt = new Option(`${s.number}. ${s.name.transliteration.id}`, s.number);
                surahSelect.add(opt);
            });
            loadSurah(1);
        });

    surahSelect.onchange = () => loadSurah(surahSelect.value);

    // 2. Load Surah & Audio
    function loadSurah(no) {
        quranText.innerHTML = "<p style='text-align:center; color:#999;'>Membuka Mushaf...</p>";
        mainAudio.src = `https://server8.mp3quran.net/afs/${no.toString().padStart(3, '0')}.mp3`;
        
        fetch(`https://api.quran.gading.dev/surah/${no}`)
            .then(r => r.json())
            .then(d => {
                const data = d.data;
                document.getElementById("currentSurahName").innerText = data.name.transliteration.id;
                audioStatus.innerText = `Mendengarkan: Surah ${data.name.transliteration.id}`;

                let html = "";
                if(no != 1 && no != 9) html += `<div style="text-align:center; margin-bottom:30px; font-size:35px;">ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê</div>`;
                
                data.verses.forEach(v => {
                    // Simpan arti dalam atribut data-translation
                    html += `<span class="ayah-text" onclick="showTranslation(${v.number.inSurah}, '${v.text.id.replace(/'/g, "\\'")}')">
                                ${v.text.arab} <span class="ayah-num">${v.number.inSurah}</span>
                             </span> `;
                });
                quranText.innerHTML = html;
            });
    }

    // 3. Fitur Interaktif Klik Ayat
    function showTranslation(num, text) {
        document.getElementById("modalAyahTitle").innerText = `Terjemah Ayat ${num}`;
        document.getElementById("modalAyahText").innerText = text;
        document.getElementById("translationModal").style.display = "block";
    }

    function closeModal() {
        document.getElementById("translationModal").style.display = "none";
    }

    // 4. Menu Dropdown Toggle
    function toggleMenu() {
        const drop = document.getElementById("myDropdown");
        drop.style.display = drop.style.display === "block" ? "none" : "block";
    }

    // Tutup menu jika klik di luar
    window.onclick = function(event) {
        if (!event.target.matches('.menu-dots')) {
            document.getElementById("myDropdown").style.display = "none";
        }
    }

    function showWaqaf() {
        alert("Panduan Waqaf:\nŸÖ : Waqaf Lazim (Harus Berhenti)\nŸÑÿß : La Washal (Jangan Berhenti)\nÿ¨ : Jaiz (Boleh Berhenti/Lanjut)");
    }
</script>

</body>
</html>
