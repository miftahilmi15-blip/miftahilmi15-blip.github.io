<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VOCABIN | E-Santri</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&family=Noto+Naskh+Arabic:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root { --primary: #1f6f51; --accent: #d4b96a; --bg: #f3fbf7; --white: #ffffff; }
  body { font-family: 'Poppins', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; }

  header { 
    background: var(--white); padding: 40px 20px 60px; text-align: center; 
    border-radius: 0 0 40px 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    position: relative; z-index: 10;
  }
  .title-4d {
    font-family: 'Montserrat', sans-serif; font-size: 26px; font-weight: 900;
    color: #fff; -webkit-text-stroke: 1.2px var(--primary);
    text-transform: uppercase; text-shadow: 0 5px 15px rgba(31, 111, 81, 0.2);
    margin: 0;
  }

  .search-container { max-width: 400px; margin: -30px auto 0; padding: 0 20px; position: relative; z-index: 20; }
  .search-wrapper {
    background: var(--white); display: flex; align-items: center;
    padding: 8px 20px; border-radius: 50px; box-shadow: 0 15px 35px rgba(0,0,0,0.1);
  }
  .search-wrapper input { flex: 1; border: none; outline: none; padding: 12px; font-size: 16px; width: 100%; background: transparent; }
  .search-wrapper button { background: var(--primary); color: white; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }

  .container { max-width: 450px; margin: 30px auto; padding: 0 20px; }
  .result-card {
    background: var(--white); border-radius: 30px; padding: 30px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.05); border-top: 8px solid var(--accent);
    display: none; animation: slideUp 0.5s ease forwards;
  }
  @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

  .word-arabic { font-family: 'Noto Naskh Arabic', serif; font-size: 40px; color: #222; text-align: right; margin: 15px 0; direction: rtl; line-height: 1.8; }
  .meaning-section { margin-top: 20px; padding-top: 15px; border-top: 1px dashed #eee; }
  .label-box { display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 10px; font-weight: 800; color: white; margin-bottom: 5px; }
  .lbl-arab { background: var(--primary); }
  .lbl-indo { background: #2980b9; }
  .lbl-eng { background: #8e44ad; }
  
  /* Tombol Game */
  .game-btn-trigger {
    background: linear-gradient(135deg, #58cc02, #23ac5e); color: white;
    padding: 18px; border-radius: 20px; text-align: center; margin-top: 25px;
    cursor: pointer; font-weight: bold; border: none; border-bottom: 4px solid #1a8a4b;
    width: 100%; font-family: 'Poppins', sans-serif;
  }
  .game-btn-trigger:active { transform: translateY(2px); border-bottom: 2px solid #1a8a4b; }

  /* Game Overlay - Fixed Hidden Problem */
  #gameOverlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: white; z-index: 9999; display: none; flex-direction: column; padding: 20px;
    box-sizing: border-box; overflow-y: auto;
  }
  .game-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 30px; }
  .progress-bar { height: 12px; background: #e5e5e5; border-radius: 10px; flex: 1; margin: 0 15px; overflow: hidden; }
  .progress-fill { width: 0%; height: 100%; background: #58cc02; transition: 0.5s; }
  
  .option-btn {
    background: white; border: 2px solid #e5e5e5; border-radius: 15px;
    padding: 18px; font-size: 16px; font-weight: 600; margin-bottom: 12px;
    cursor: pointer; transition: 0.2s; border-bottom: 4px solid #e5e5e5;
    text-align: left; width: 100%; font-family: 'Poppins', sans-serif;
  }
  .option-btn:hover { background: #f7f7f7; }
  .option-btn.correct { background: #d7ffb1; border-color: #58cc02; color: #58cc02; border-bottom-color: #58cc02; }
  .option-btn.wrong { background: #ffdfe0; border-color: #ee2a33; color: #ee2a33; border-bottom-color: #ee2a33; }

  .loader { display: none; text-align: center; padding: 20px; }
  .spinner { width: 30px; height: 30px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto; }
  @keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>
<body>

<header>
  <a href="index.html" style="position: absolute; left: 20px; top: 35px; text-decoration: none; color: var(--primary); font-weight: bold; font-size: 20px;">‚Üê</a>
  <h1 class="title-4d">VOCABIN</h1>
  <p style="font-size: 10px; color: #888; margin-top: 5px; font-weight: 600;">BELAJAR BAHASA ITU MUDAH</p>
</header>

<div class="search-container">
  <div class="search-wrapper">
    <input type="text" id="searchInput" placeholder="Cari kata (Indo/English)..." onkeypress="if(event.key === 'Enter') cariKamus()">
    <button onclick="cariKamus()">üîç</button>
  </div>
</div>

<div class="container">
  <div id="loader" class="loader"><div class="spinner"></div></div>

  <div id="resultCard" class="result-card">
    <div id="resTitle" style="font-weight:900; color:var(--primary); font-size:22px; text-transform:uppercase; letter-spacing: 1px;">...</div>
    <div class="word-arabic" id="resArab">...</div>

    <div class="meaning-section">
      <span class="label-box lbl-arab">ARAB</span>
      <p id="resArDetail" style="margin: 5px 0 0 0; color: #555;">...</p>
    </div>

    <div class="meaning-section">
      <span class="label-box lbl-indo">INDONESIA</span>
      <p id="resIndo" style="margin: 5px 0 0 0; color: #555;">...</p>
    </div>

    <div class="meaning-section">
      <span class="label-box lbl-eng">INGGRIS</span>
      <p id="resEng" style="margin: 5px 0 0 0; color: #555;">...</p>
    </div>

    <button id="btnGame" class="game-btn-trigger" style="display:none;" onclick="openGame()">
      üéÆ UJI HAFALAN SEKARANG
    </button>
  </div>
</div>

<div id="gameOverlay">
    <div class="game-header">
        <span onclick="closeGame()" style="font-size: 28px; font-weight: bold; cursor: pointer; color: #ccc;">‚úï</span>
        <div class="progress-bar"><div id="pFill" class="progress-fill"></div></div>
        <span id="streak" style="font-weight: 800; color: #ff9600; font-size: 18px;">üî• 0</span>
    </div>

    <div style="flex: 1;">
        <p id="gameInstruction" style="color: #afafaf; font-size: 13px; font-weight: 800; text-transform: uppercase; margin-bottom: 5px;">Tebak Bahasa Inggrisnya:</p>
        <h1 id="gameQuestion" style="font-size: 32px; margin: 0 0 30px 0; color: #3c3c3c; font-weight: 700;">...</h1>
        
        <div id="optionsContainer">
            </div>
    </div>
    
    <div id="feedback" style="margin-top: 20px; padding: 25px; border-radius: 20px; display: none; text-align: center;">
        <h2 id="feedbackText" style="margin: 0 0 15px 0; font-weight: 800;">Luar Biasa!</h2>
        <button onclick="nextSoal()" id="btnNext" style="width: 100%; padding: 18px; border-radius: 15px; border: none; background: #58cc02; color: white; font-weight: bold; cursor: pointer; font-size: 16px; box-shadow: 0 4px 0 #1a8a4b;">LANJUTKAN</button>
    </div>
</div>

<script>
  let lastData = { id: '', ar: '', en: '' };
  let currentStreak = 0;

  function playSound(text, lang) {
    const msg = new SpeechSynthesisUtterance();
    msg.text = text; msg.lang = lang; msg.rate = 0.8;
    window.speechSynthesis.speak(msg);
  }

  async function cariKamus() {
    const query = document.getElementById('searchInput').value.trim();
    if (!query) return;

    document.getElementById('loader').style.display = 'block';
    document.getElementById('resultCard').style.display = 'none';

    try {
      const [resAr, resEn] = await Promise.all([
        fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=ar&dt=t&q=${encodeURI(query)}`),
        fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=en&dt=t&q=${encodeURI(query)}`)
      ]);
      
      const dataAr = await resAr.json();
      const dataEn = await resEn.json();

      lastData = { id: query, ar: dataAr[0][0][0], en: dataEn[0][0][0] };

      document.getElementById('resTitle').innerText = query;
      document.getElementById('resArab').innerHTML = `${lastData.ar} <button onclick="playSound('${lastData.ar}', 'ar-SA')" style="background:none; border:none; color:var(--primary); cursor:pointer; font-size:24px; vertical-align: middle;">üîä</button>`;
      document.getElementById('resArDetail').innerText = `Bahasa Arab dari "${query}"`;
      document.getElementById('resIndo').innerText = query;
      document.getElementById('resEng').innerHTML = `${lastData.en} <button onclick="playSound('${lastData.en}', 'en-US')" style="background:none; border:none; color:#8e44ad; cursor:pointer; font-size:20px; vertical-align: middle;">üîä</button>`;

      document.getElementById('loader').style.display = 'none';
      document.getElementById('resultCard').style.display = 'block';
      document.getElementById('btnGame').style.display = 'block'; // Munculkan tombol game

    } catch (e) {
      document.getElementById('loader').style.display = 'none';
      alert("Koneksi bermasalah.");
    }
  }

  // --- GAME LOGIC ---
  function openGame() {
    document.body.style.overflow = 'hidden'; // Kunci scroll body
    document.getElementById('gameOverlay').style.display = 'flex';
    currentStreak = 0;
    document.getElementById('pFill').style.width = '0%';
    document.getElementById('streak').innerText = "üî• 0";
    nextSoal();
  }

  function closeGame() {
    document.body.style.overflow = 'auto'; // Aktifkan scroll body
    document.getElementById('gameOverlay').style.display = 'none';
  }

  function nextSoal() {
    document.getElementById('feedback').style.display = 'none';
    const isEnglishTask = Math.random() > 0.5;
    const qText = lastData.id;
    const correctAns = isEnglishTask ? lastData.en : lastData.ar;
    
    document.getElementById('gameInstruction').innerText = isEnglishTask ? "Tebak Bahasa Inggrisnya:" : "Tebak Bahasa Arabnya:";
    document.getElementById('gameQuestion').innerText = qText;

    // Dummy distractors
    const distractors = isEnglishTask ? ["Nothing", "Something", "Everything", "Maybe"] : ["ŸÑÿß ÿ¥Ÿäÿ°", "ÿ¥Ÿäÿ° ŸÖÿß", "ŸÉŸÑ ÿ¥Ÿäÿ°", "ÿ±ÿ®ŸÖÿß"];
    let options = [correctAns, distractors[Math.floor(Math.random()*4)], distractors[Math.floor(Math.random()*4)]];
    
    // Hilangkan duplikat jika ada & Acak
    options = [...new Set(options)].sort(() => Math.random() - 0.5);

    let html = "";
    options.forEach(opt => {
        html += `<button class="option-btn" onclick="checkGameAns(this, '${opt}', '${correctAns.replace(/'/g, "\\'")}')">${opt}</button>`;
    });
    document.getElementById('optionsContainer').innerHTML = html;
  }

  function checkGameAns(btn, selected, correct) {
    const allBtns = document.querySelectorAll('.option-btn');
    allBtns.forEach(b => b.style.pointerEvents = 'none');

    if (selected.toLowerCase() === correct.toLowerCase()) {
        btn.classList.add('correct');
        currentStreak++;
        document.getElementById('streak').innerText = "üî• " + currentStreak;
        document.getElementById('pFill').style.width = Math.min(currentStreak * 10, 100) + "%";
        showFeedback(true);
    } else {
        btn.classList.add('wrong');
        // Tunjukkan mana yang benar
        allBtns.forEach(b => {
          if(b.innerText.toLowerCase() === correct.toLowerCase()) b.classList.add('correct');
        });
        currentStreak = 0;
        document.getElementById('streak').innerText = "üî• 0";
        showFeedback(false);
    }
  }

  function showFeedback(isCorrect) {
    const f = document.getElementById('feedback');
    const ft = document.getElementById('feedbackText');
    f.style.display = 'block';
    f.style.background = isCorrect ? '#d7ffb1' : '#ffdfe0';
    ft.style.color = isCorrect ? '#58cc02' : '#ee2a33';
    ft.innerText = isCorrect ? "Luar Biasa!" : "Aduh, Kurang Tepat!";
  }
</script>

</body>
</html>
